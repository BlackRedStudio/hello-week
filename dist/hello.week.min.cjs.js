"use strict";function _interopNamespace(t){if(t&&t.__esModule)return t;var e={};return t&&Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),e.default=t,e}Object.defineProperty(exports,"__esModule",{value:!0});const cssClasses={CALENDAR:"hello-week",DAY:"day",MONTH:"month",NAVIGATION:"navigation",NEXT:"next",PERIOD:"period",PREV:"prev",RTL:"rtl",WEEK:"week"},cssStates={IS_BEGIN_RANGE:"is-begin-range",IS_DISABLED:"is-disabled",IS_END_RANGE:"is-end-range",IS_HIGHLIGHT:"is-highlight",IS_SELECTED:"is-selected",IS_RANGE:"is-range",IS_TODAY:"is-today",IS_WEEKEND:"is-weekend"},daysWeek={FRIDAY:5,MONDAY:1,SATURDAY:6,SUNDAY:0,THURSDAY:4,TUESDAY:2,WEDNESDAY:3},margins={RIGHT:"margin-right",LEFT:"margin-left"},defaults={selector:".hello-week",lang:"en",langFolder:"./langs/",format:"DD/MM/YYYY",monthShort:!1,weekShort:!0,defaultDate:null,minDate:null,maxDate:null,disableDaysOfWeek:null,timezoneOffset:(new Date).getTimezoneOffset(),disableDates:null,weekStart:0,daysSelected:null,daysHighlight:null,multiplePick:!1,disablePastDays:!1,todayHighlight:!0,range:!1,locked:!1,rtl:!1,nav:["◀","▶"],onLoad:()=>{},onClear:()=>{},onNavigation:()=>{},onUpdate:t=>t,onSelect:t=>t,dayRender:t=>t};function isDef(t){return null!=t}function isObject(t){return null!==t&&"object"==typeof t}function isArray(t){return null!==t&&Array.isArray(t)}function isString(t){return"string"==typeof t}function render(t,e){if(t.split)return document.createTextNode(t);const s=document.createElement(t.nodeName);return isDef(t.attributes)&&diffProps(t,s),(t.children||[]).forEach(t=>s.appendChild(render(t))),e?e.appendChild(s):s}function diffProps(t,e){for(const s of Object.keys(t.attributes))"class"===s?classProps(t,e,s):"style"===s?styleProps(t,e,s):"data"===s?dataProps(t,e,s):setAttr(e,s,t.attributes[s])}function dataProps(t,e,s){for(const a of Object.keys(t.attributes[s]))setAttr(e,`data-${s}`,t.attributes[s][a])}function classProps(t,e,s){isString(t.attributes[s])?e.className=t.attributes[s]:isArray(t.attributes[s])&&t.attributes[s].forEach(t=>{addClass(e,t)})}function styleProps(t,e,s){if(isString(t.attributes[s]))e.style=t.attributes[s];else if(isObject(t.attributes[s]))for(const a of Object.keys(t.attributes[s]))e.style[a]=t.attributes[s][a]}function h(t,e,...s){const a={nodeName:t};return e&&(a.attributes=e),s.length&&(a.children=[].concat(...s)),a}function setAttr(t,e,s){return t.setAttribute(e,s)}function addClass(t,e){return t.classList.add(e)}function removeClass(t,e){return t.classList.remove(e)}function toggleClass(t,e){return t.classList.toggle(e)}function existElement(t,e){return isDef(e)?e.querySelector(`.${t}`):document.querySelector(`.${t}`)}function extend(t,e){return Object.assign(t,e)}function getIndexForEventTarget(t,e){return Array.prototype.slice.call(t).indexOf(e)+1}function toDate(t,e){const s=setTimeZone(t,e);return defaultFormat(s.getDate(),s.getMonth(),s.getFullYear())}function defaultFormat(t,e,s){return`${s}-${("0"+(e+1)).slice(-2)}-${("0"+t).slice(-2)}`}function formatDate(t,e,s,a){const i=setTimeZone(t,a);return s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=s||defaults.format).replace("dd",i.getDate().toString())).replace("DD",(i.getDate()>9?i.getDate():"0"+i.getDate()).toString())).replace("mm",(i.getMonth()+1).toString())).replace("MMM",e.months[i.getMonth()])).replace("MM",(i.getMonth()+1>9?i.getMonth()+1:"0"+(i.getMonth()+1)).toString())).replace("mmm",e.monthsShort[i.getMonth()])).replace("yyyy",i.getFullYear().toString())).replace("YYYY",i.getFullYear().toString())).replace("YY",i.getFullYear().toString().substring(2))).replace("yy",i.getFullYear().toString().substring(2))}function setTimeZone(t,e){const s=isDef(t)?new Date(t):new Date;return e=e||s.getTimezoneOffset(),s.setTime(s.getTime()+60*e*1e3),s}function formatDateToCompare(t){const e=new Date(t);return Number(""+e.getFullYear()+(e.getMonth()+1)+(e.getDate()>9?e.getDate():"0"+e.getDate()).toString())}function isAfter(t,e){return formatDateToCompare(t)>formatDateToCompare(e)}function isBefore(t,e){return formatDateToCompare(t)<formatDateToCompare(e)}function isBetween(t,e,s){return isAfter(s,t)&&isBefore(s,e)}function isSame(t,e){return formatDateToCompare(t)===formatDateToCompare(e)}function isSameOrAfter(t,e){return isSame(t,e)||isAfter(t,e)}function isSameOrBefore(t,e){return isSame(t,e)||isBefore(t,e)}function template(t,e){const s={};if(!isDef(t.selector))throw new Error("You need to specify a selector!");return isString(t.selector)?s.selector=t.selector?document.querySelector(t.selector):t.selector:s.selector=t.selector,isDef(s.selector)?t.selector!==cssClasses.CALENDAR&&addClass(s.selector,cssClasses.CALENDAR):s.selector=render(h("div",{class:[t.selector,cssClasses.CALENDAR]})),s.calendar={},s.calendar.navigation=existElement(cssClasses.NAVIGATION,s.selector),isDef(s.calendar.navigation)||(s.calendar.navigation=render(h("div",{class:cssClasses.NAVIGATION}),s.selector)),isDef(t.nav[0])&&(s.calendar.prevMonth=render(h("div",{class:cssClasses.PREV},t.nav[0]),s.calendar.navigation),s.calendar.prevMonth.addEventListener("click",()=>e.prev.cb())),s.calendar.period=existElement(cssClasses.PERIOD,s.selector),isDef(s.calendar.period)||(s.calendar.period=render(h("div",{class:cssClasses.PERIOD}),s.calendar.navigation)),isDef(t.nav[1])&&(s.calendar.nextMonth=render(h("div",{class:cssClasses.NEXT},t.nav[1]),s.calendar.navigation),s.calendar.nextMonth.addEventListener("click",()=>e.next.cb())),s.calendar.week=existElement(cssClasses.WEEK,s.selector),isDef(s.calendar.week)||(s.calendar.week=render(h("div",{class:cssClasses.WEEK}),s.selector)),s.calendar.month=existElement(cssClasses.MONTH,s.selector),isDef(s.calendar.month)||(s.calendar.month=render(h("div",{class:cssClasses.MONTH}),s.selector)),t.rtl&&(addClass(s.calendar.week,cssClasses.RTL),addClass(s.calendar.month,cssClasses.RTL)),s}function getIntervalOfDates(t,e,s){const a=[];let i=t;const n=function(t){const e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e.getTime()};for(;i<=e;)a.push(formatDate(i,s)),i=n.call(i,1);return a}function date(t){return isDef(t)?new Date(t):new Date}function setMinDate(t){const e=date(t);return toDate(e.setDate(e.getDate()-1))}function setMaxDate(t){const e=date(t);return toDate(e.setDate(e.getDate()+1))}class HelloWeek{constructor(t){this.todayDate=toDate(new Date),this.date=new Date,this.intervalRange={},this.daysSelected=[],this.options=extend(extend({},defaults),t),this.prevOptions=extend(extend({},defaults),t);const{calendar:e,selector:s}=template(this.options,{prev:{cb:()=>this.prev()},next:{cb:()=>this.next()}});this.selector=s,this.calendar=e,this.isRTL=this.options.rtl?margins.RIGHT:margins.LEFT,new Promise(function(t){t(_interopNamespace(require(this.options.langFolder+this.options.lang+".js")))}).then(t=>t.default).then(t=>{this.langs=t,this.willMount()})}destroy(){this.removeStatesClass(),this.selector.remove()}prev(){const t=this.date.getMonth()-1;this.date.setMonth(t),this.update(),this.options.onNavigation()}next(){const t=this.date.getMonth()+1;this.date.setMonth(t),this.update(),this.options.onNavigation()}prevYear(){const t=this.date.getFullYear()-1;this.date.setFullYear(t),this.update(),this.options.onNavigation()}nextYear(){const t=this.date.getFullYear()+1;this.date.setFullYear(t),this.update(),this.options.onNavigation()}update(){this.options.onUpdate(this.options),this.clearCalendar(),this.mount()}reset(t,e){this.clearCalendar(),this.options=extend(this.prevOptions,t),this.willMount(e)}goToDate(t=this.todayDate){this.date=new Date(t),this.date.setDate(1),this.update()}getDaySelected(){return this.daysSelected.sort((t,e)=>formatDateToCompare(t)-formatDateToCompare(e)).map(t=>formatDate(t,this.langs,this.options.format))}getLastDaySelected(){return this.lastSelectedDay}getDaysHighlight(){return this.daysHighlight}getMonth(){return this.date.getMonth()+1}getYear(){return this.date.getFullYear()}setDaysHighlight(t){this.daysHighlight=[...this.daysHighlight,...t]}setMultiplePick(t){this.options.multiplePick=t}setDisablePastDays(t){this.options.disablePastDays=t}setTodayHighlight(t){this.options.todayHighlight=t}setRange(t){isArray(this.options.range)?(this.intervalRange.begin=this.options.range[0],this.intervalRange.end=this.options.range[1]):this.options.range=t}setLocked(t){this.options.locked=t}setMinDate(t){this.options.minDate=setMinDate(t)}setMaxDate(t){this.options.maxDate=setMaxDate(t)}willMount(t){if(this.daysHighlight=this.options.daysHighlight?this.options.daysHighlight:[],this.daysSelected=this.options.daysSelected?this.options.daysSelected:[],this.daysSelected.length&&!this.options.multiplePick)throw new Error(`There are ${this.daysSelected.length} dates selected, but the multiplePick option is FALSE!`);this.options.defaultDate&&(this.date=setTimeZone(this.options.defaultDate,this.options.timezoneOffset),this.defaultDate=setTimeZone(this.options.defaultDate,this.options.timezoneOffset),this.defaultDate.setDate(this.defaultDate.getDate())),this.date.setDate(1),this.options.minDate&&this.setMinDate(this.options.minDate),this.options.maxDate&&this.setMaxDate(this.options.maxDate),this.options.range&&this.setRange(this.options.range),this.mount(),this.options.onLoad(),t&&t()}selectDay(t){this.daysOfMonth=this.selector.querySelectorAll("."+cssClasses.MONTH+" ."+cssClasses.DAY);for(const e of Object.keys(this.daysOfMonth))this.handleClickInteraction(this.daysOfMonth[e],t),this.options.range&&this.handleMouseInteraction(this.daysOfMonth[e])}handleClickInteraction(t,e){t.addEventListener("click",t=>{const s=getIndexForEventTarget(this.daysOfMonth,t.target);this.days[s].locked||(this.lastSelectedDay=this.days[s].date,this.options.range||(this.options.multiplePick?(this.days[s].date&&(this.daysSelected=this.daysSelected.filter(t=>formatDateToCompare(t)!==formatDateToCompare(this.lastSelectedDay))),this.days[s].isSelected||this.daysSelected.push(this.lastSelectedDay)):(this.days[s].locked||this.removeStatesClass(),this.daysSelected=[],this.daysSelected.push(this.lastSelectedDay))),toggleClass(t.target,cssStates.IS_SELECTED),this.days[s].isSelected=!this.days[s].isSelected,this.options.range&&(this.intervalRange.begin&&this.intervalRange.end&&(this.intervalRange={},this.removeStatesClass()),this.intervalRange.begin&&!this.intervalRange.end&&(this.intervalRange.end=this.days[s].date,this.daysSelected=getIntervalOfDates(this.intervalRange.begin,this.intervalRange.end,this.langs),addClass(t.target,cssStates.IS_END_RANGE),this.intervalRange.begin>this.intervalRange.end&&(this.intervalRange={},this.removeStatesClass())),this.intervalRange.begin||(this.intervalRange.begin=this.days[s].date),addClass(t.target,cssStates.IS_SELECTED)),this.options.onSelect(this.days[s]),e&&e(this.days[s]))})}handleMouseInteraction(t){t.addEventListener("mouseover",t=>{const e=getIndexForEventTarget(this.daysOfMonth,t.target);if(!(!this.intervalRange.begin||this.intervalRange.begin&&this.intervalRange.end)){this.removeStatesClass();for(let t=1;t<=Object.keys(this.days).length;t++)this.days[t].isSelected=!1,isSameOrAfter(this.days[e].date,this.intervalRange.begin)&&isSameOrAfter(this.days[t].date,this.intervalRange.begin)&&isSameOrBefore(this.days[t].date,this.days[e].date)&&(addClass(this.days[t].element,cssStates.IS_SELECTED),addClass(this.days[t].element,cssStates.IS_RANGE),isSame(this.days[t].date,this.intervalRange.begin)&&addClass(this.days[t].element,cssStates.IS_BEGIN_RANGE))}})}creatWeek(t){render(h("span",{class:cssClasses.DAY},t),this.calendar.week)}createMonth(){const t=this.date.getMonth();for(;this.date.getMonth()===t;)this.createDay(this.date),this.date.setDate(this.date.getDate()+1);this.date.setMonth(this.date.getMonth()-1),this.selectDay()}createDay(t){const e=t.getDate(),s=t.getDay();let a={day:e,date:toDate(t),isWeekend:!1,locked:!1,isToday:!1,isRange:!1,isSelected:!1,isHighlight:!1,events:void 0,attributes:{class:[cssClasses.DAY],style:{}},node:void 0,element:void 0};this.days=this.days||{},s!==daysWeek.SUNDAY&&s!==daysWeek.SATURDAY||(a.attributes.class.push(cssStates.IS_WEEKEND),a.isWeekend=!0),(this.options.locked||this.options.disableDaysOfWeek&&this.options.disableDaysOfWeek.includes(s)||this.options.disablePastDays&&isSameOrBefore(this.date,this.defaultDate)||this.options.minDate&&isSameOrAfter(this.options.minDate,a.date)||this.options.maxDate&&isSameOrBefore(this.options.maxDate,a.date))&&(a.attributes.class.push(cssStates.IS_DISABLED),a.locked=!0),this.options.disableDates&&this.disabledDays(a),isSame(this.todayDate,a.date)&&(a.isToday=!0,this.options.todayHighlight&&a.attributes.class.push(cssStates.IS_TODAY)),this.daysSelected.find(t=>{isSame(t,a.date)&&(a.attributes.class.push(cssStates.IS_SELECTED),a.isSelected=!0)}),isBetween(this.intervalRange.begin,this.intervalRange.end,a.date)&&(a.attributes.class.push(cssStates.IS_RANGE),a.isRange=!0),isSame(a.date,this.intervalRange.begin)&&a.attributes.class.push(cssStates.IS_BEGIN_RANGE),isSame(a.date,this.intervalRange.end)&&a.attributes.class.push(cssStates.IS_END_RANGE),this.daysHighlight&&this.highlightDays(a),1===a.day&&(this.options.weekStart===daysWeek.SUNDAY?a.attributes.style[this.isRTL]=s*(100/Object.keys(daysWeek).length)+"%":s===daysWeek.SUNDAY?a.attributes.style[this.isRTL]=(Object.keys(daysWeek).length-this.options.weekStart)*(100/Object.keys(daysWeek).length)+"%":a.attributes.style[this.isRTL]=(s-1)*(100/Object.keys(daysWeek).length)+"%"),a.node=h("div",a.attributes,a.day.toString()),(a=this.options.dayRender(a)).element=render(a.node,this.calendar.month),this.days[a.day]=a}disabledDays(t){isArray(this.options.disableDates[0])?this.options.disableDates.map(e=>{isSameOrAfter(t.date,e[0])&&isSameOrBefore(t.date,e[1])&&(t.attributes.class.push(cssStates.IS_DISABLED),t.locked=!0)}):this.options.disableDates.map(e=>{isSame(t.date,e)&&(t.attributes.class.push(cssStates.IS_DISABLED),t.locked=!0)})}highlightDays(t){for(const e in this.daysHighlight)this.daysHighlight[e].days[0]instanceof Array?this.daysHighlight[e].days.map(s=>{isSameOrAfter(t.date,s[0])&&isSameOrBefore(t.date,s[1])&&this.computedAttributes(e,t)}):this.daysHighlight[e].days.map(s=>{isSame(t.date,s)&&this.computedAttributes(e,t)})}computedAttributes(t,e){const{attributes:s,days:a,...i}=this.daysHighlight[t];e=extend(e,i);for(const t in s)e.attributes[t]&&s[t]?e.attributes[t]=extend(e.attributes[t],s[t]):s[t]&&(e.attributes[t]=s[t]);e.attributes.class.push(cssStates.IS_HIGHLIGHT),e.isHighlight=!0}monthsAsString(t){return this.options.monthShort?this.langs.monthsShort[t]:this.langs.months[t]}weekAsString(t){return this.options.weekShort?this.langs.daysShort[t]:this.langs.days[t]}mount(){this.calendar.period&&(this.calendar.period.innerHTML=this.monthsAsString(this.date.getMonth())+" "+this.date.getFullYear());const t=[];this.calendar.week.textContent="";for(let e=this.options.weekStart;e<this.langs.daysShort.length;e++)t.push(e);for(let e=0;e<this.options.weekStart;e++)t.push(e);for(const e of t)this.creatWeek(this.weekAsString(e));this.createMonth()}clearCalendar(){this.calendar.month.textContent=""}removeStatesClass(){for(const t of Object.keys(this.daysOfMonth))removeClass(this.daysOfMonth[t],cssStates.IS_SELECTED),removeClass(this.daysOfMonth[t],cssStates.IS_RANGE),removeClass(this.daysOfMonth[t],cssStates.IS_BEGIN_RANGE),removeClass(this.daysOfMonth[t],cssStates.IS_END_RANGE),this.days[+t+1].isSelected=!1}}const HelloWeek$1=HelloWeek;window.HelloWeek=HelloWeek$1,exports.HelloWeek=HelloWeek$1,exports.createElement=h,exports.default=HelloWeek,exports.el=h,exports.render=render;
