"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t="hello-week",e="day",s="month",i="navigation",a="next",n="period",o="prev",r="rtl",h="week",l="is-begin-range",d="is-disabled",c="is-end-range",g="is-highlight",u="is-selected",p="is-range",y="is-today",f="is-weekend",D={FRIDAY:5,MONDAY:1,SATURDAY:6,SUNDAY:0,THURSDAY:4,TUESDAY:2,WEDNESDAY:3},b="margin-right",m="margin-left",v={selector:".hello-week",lang:"en",langFolder:"./langs/",format:"DD/MM/YYYY",monthShort:!1,weekShort:!0,defaultDate:null,minDate:null,maxDate:null,disableDaysOfWeek:null,timezoneOffset:(new Date).getTimezoneOffset(),disableDates:null,weekStart:0,daysSelected:null,daysHighlight:null,multiplePick:!1,disablePastDays:!1,todayHighlight:!0,range:!1,locked:!1,rtl:!1,nav:["◀","▶"],onLoad:()=>{},onClear:()=>{},onNavigation:()=>{},onUpdate:t=>t,onSelect:t=>t,beforeCreate:t=>t};function S(t){return null!=t}function k(t){return null!==t&&Array.isArray(t)}function M(t){return"string"==typeof t}function w(t,e){if(t.split)return document.createTextNode(t);const s=document.createElement(t.nodeName);return S(t.attributes)&&function(t,e){for(const s of Object.keys(t.attributes))"class"===s?R(t,e,s):"style"===s?Y(t,e,s):"data"===s?O(t,e,s):x(e,s,t.attributes[s])}(t,s),(t.children||[]).forEach(t=>s.appendChild(w(t))),e?e.appendChild(s):s}function O(t,e,s){for(const i of Object.keys(t.attributes[s]))x(e,`data-${s}`,t.attributes[s][i])}function R(t,e,s){M(t.attributes[s])?e.className=t.attributes[s]:k(t.attributes[s])&&t.attributes[s].forEach(t=>{H(e,t)})}function Y(t,e,s){if(M(t.attributes[s]))e.style=t.attributes[s];else if(null!==(i=t.attributes[s])&&"object"==typeof i)for(const i of Object.keys(t.attributes[s]))e.style[i]=t.attributes[s][i];var i}function A(t,e,...s){const i={nodeName:t};return e&&(i.attributes=e),s.length&&(i.children=[].concat(...s)),i}function x(t,e,s){return t.setAttribute(e,s)}function H(t,e){return t.classList.add(e)}function T(t,e){return t.classList.remove(e)}function j(t,e){return S(e)?e.querySelector(`.${t}`):document.querySelector(`.${t}`)}function C(t,e){return Object.assign(t,e)}function F(t,e){return Array.prototype.slice.call(t).indexOf(e)+1}function L(t,e){const s=E(t,e);return i=s.getDate(),a=s.getMonth(),`${s.getFullYear()}-${("0"+(a+1)).slice(-2)}-${("0"+i).slice(-2)}`;var i,a}function N(t,e,s,i){const a=E(t,i);return s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=s||v.format).replace("dd",a.getDate().toString())).replace("DD",(a.getDate()>9?a.getDate():"0"+a.getDate()).toString())).replace("mm",(a.getMonth()+1).toString())).replace("MMM",e.months[a.getMonth()])).replace("MM",(a.getMonth()+1>9?a.getMonth()+1:"0"+(a.getMonth()+1)).toString())).replace("mmm",e.monthsShort[a.getMonth()])).replace("yyyy",a.getFullYear().toString())).replace("YYYY",a.getFullYear().toString())).replace("YY",a.getFullYear().toString().substring(2))).replace("yy",a.getFullYear().toString().substring(2))}function E(t,e){const s=S(t)?new Date(t):new Date;return e=e||s.getTimezoneOffset(),s.setTime(s.getTime()+60*e*1e3),s}function P(t){const e=new Date(t);return Number(""+e.getFullYear()+(e.getMonth()+1)+(e.getDate()>9?e.getDate():"0"+e.getDate()).toString())}function U(t,e){return P(t)>P(e)}function W(t,e){return P(t)<P(e)}function $(t,e){return P(t)===P(e)}function q(t,e){return $(t,e)||U(t,e)}function z(t,e){return $(t,e)||W(t,e)}function I(t){return S(t)?new Date(t):new Date}function _(t){const e=I(t);return L(e.setDate(e.getDate()-1))}function B(t){const e=I(t);return L(e.setDate(e.getDate()+1))}class G{constructor(e){this.todayDate=L(new Date),this.date=new Date,this.intervalRange={},this.daysSelected=[],this.options=C(C({},v),e),this.prevOptions=C(C({},v),e);const{calendar:l,selector:d}=function(e,l){const d={};if(!S(e.selector))throw new Error("You need to specify a selector!");return M(e.selector)?d.selector=e.selector?document.querySelector(e.selector):e.selector:d.selector=e.selector,S(d.selector)?e.selector!==t&&H(d.selector,t):d.selector=w(A("div",{class:[e.selector,t]})),d.calendar={},d.calendar.navigation=j(i,d.selector),S(d.calendar.navigation)||(d.calendar.navigation=w(A("div",{class:i}),d.selector)),S(e.nav[0])&&(d.calendar.prevMonth=w(A("div",{class:o},e.nav[0]),d.calendar.navigation),d.calendar.prevMonth.addEventListener("click",()=>l.prev.cb())),d.calendar.period=j(n,d.selector),S(d.calendar.period)||(d.calendar.period=w(A("div",{class:n}),d.calendar.navigation)),S(e.nav[1])&&(d.calendar.nextMonth=w(A("div",{class:a},e.nav[1]),d.calendar.navigation),d.calendar.nextMonth.addEventListener("click",()=>l.next.cb())),d.calendar.week=j(h,d.selector),S(d.calendar.week)||(d.calendar.week=w(A("div",{class:h}),d.selector)),d.calendar.month=j(s,d.selector),S(d.calendar.month)||(d.calendar.month=w(A("div",{class:s}),d.selector)),e.rtl&&(H(d.calendar.week,r),H(d.calendar.month,r)),d}(this.options,{prev:{cb:()=>this.prev()},next:{cb:()=>this.next()}});this.selector=d,this.calendar=l,this.isRTL=this.options.rtl?b:m,new Promise((function(t){t(function(t){if(t&&t.__esModule)return t;var e={};return t&&Object.keys(t).forEach((function(s){var i=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:function(){return t[s]}})})),e.default=t,e}(require(this.options.langFolder+this.options.lang+".js")))})).then(t=>t.default).then(t=>{this.langs=t,this.willMount()})}destroy(){this.removeStatesClass(),this.selector.remove()}prev(){const t=this.date.getMonth()-1;this.date.setMonth(t),this.update(),this.options.onNavigation()}next(){const t=this.date.getMonth()+1;this.date.setMonth(t),this.update(),this.options.onNavigation()}prevYear(){const t=this.date.getFullYear()-1;this.date.setFullYear(t),this.update(),this.options.onNavigation()}nextYear(){const t=this.date.getFullYear()+1;this.date.setFullYear(t),this.update(),this.options.onNavigation()}update(){this.options.onUpdate(this.options),this.clearCalendar(),this.mount()}reset(t,e){this.clearCalendar(),this.options=C(this.prevOptions,t),this.willMount(e)}goToDate(t=this.todayDate){this.date=new Date(t),this.date.setDate(1),this.update()}getDaySelected(){return this.daysSelected.sort((t,e)=>P(t)-P(e)).map(t=>N(t,this.langs,this.options.format))}getLastDaySelected(){return this.lastSelectedDay}getDaysHighlight(){return this.daysHighlight}getMonth(){return this.date.getMonth()+1}getYear(){return this.date.getFullYear()}setDaysHighlight(t){this.daysHighlight=[...this.daysHighlight,...t]}setMultiplePick(t){this.options.multiplePick=t}setDisablePastDays(t){this.options.disablePastDays=t}setTodayHighlight(t){this.options.todayHighlight=t}setRange(t){k(this.options.range)?(this.intervalRange.begin=this.options.range[0],this.intervalRange.end=this.options.range[1]):this.options.range=t}setLocked(t){this.options.locked=t}setMinDate(t){this.options.minDate=_(t)}setMaxDate(t){this.options.maxDate=B(t)}willMount(t){if(this.daysHighlight=this.options.daysHighlight?this.options.daysHighlight:[],this.daysSelected=this.options.daysSelected?this.options.daysSelected:[],this.daysSelected.length&&!this.options.multiplePick)throw new Error(`There are ${this.daysSelected.length} dates selected, but the multiplePick option is FALSE!`);this.options.defaultDate&&(this.date=E(this.options.defaultDate,this.options.timezoneOffset),this.defaultDate=E(this.options.defaultDate,this.options.timezoneOffset),this.defaultDate.setDate(this.defaultDate.getDate())),this.date.setDate(1),this.options.minDate&&this.setMinDate(this.options.minDate),this.options.maxDate&&this.setMaxDate(this.options.maxDate),this.options.range&&this.setRange(this.options.range),this.mount(),this.options.onLoad(),t&&t()}selectDay(t){this.daysOfMonth=this.selector.querySelectorAll("."+s+" ."+e);for(const e of Object.keys(this.daysOfMonth))this.handleClickInteraction(this.daysOfMonth[e],t),this.options.range&&this.handleMouseInteraction(this.daysOfMonth[e])}handleClickInteraction(t,e){t.addEventListener("click",t=>{const s=F(this.daysOfMonth,t.target);var i,a;this.days[s].locked||(this.lastSelectedDay=this.days[s].date,this.options.range||(this.options.multiplePick?(this.days[s].date&&(this.daysSelected=this.daysSelected.filter(t=>P(t)!==P(this.lastSelectedDay))),this.days[s].isSelected||this.daysSelected.push(this.lastSelectedDay)):(this.days[s].locked||this.removeStatesClass(),this.daysSelected=[],this.daysSelected.push(this.lastSelectedDay))),i=t.target,a=u,i.classList.toggle(a),this.days[s].isSelected=!this.days[s].isSelected,this.options.range&&(this.intervalRange.begin&&this.intervalRange.end&&(this.intervalRange={},this.removeStatesClass()),this.intervalRange.begin&&!this.intervalRange.end&&(this.intervalRange.end=this.days[s].date,this.daysSelected=function(t,e,s){const i=[];let a=t;const n=function(t){const e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e.getTime()};for(;a<=e;)i.push(N(a,s)),a=n.call(a,1);return i}(this.intervalRange.begin,this.intervalRange.end,this.langs),H(t.target,c),this.intervalRange.begin>this.intervalRange.end&&(this.intervalRange={},this.removeStatesClass())),this.intervalRange.begin||(this.intervalRange.begin=this.days[s].date),H(t.target,u)),this.options.onSelect(this.days[s]),e&&e(this.days[s]))})}handleMouseInteraction(t){t.addEventListener("mouseover",t=>{const e=F(this.daysOfMonth,t.target);if(!(!this.intervalRange.begin||this.intervalRange.begin&&this.intervalRange.end)){this.removeStatesClass();for(let t=1;t<=Object.keys(this.days).length;t++)this.days[t].isSelected=!1,q(this.days[e].date,this.intervalRange.begin)&&q(this.days[t].date,this.intervalRange.begin)&&z(this.days[t].date,this.days[e].date)&&(H(this.days[t].element,u),H(this.days[t].element,p),$(this.days[t].date,this.intervalRange.begin)&&H(this.days[t].element,l))}})}creatWeek(t){w(A("span",{class:e},t),this.calendar.week)}createMonth(){const t=this.date.getMonth();for(;this.date.getMonth()===t;)this.createDay(this.date),this.date.setDate(this.date.getDate()+1);this.date.setMonth(this.date.getMonth()-1),this.selectDay()}createDay(t){const s=t.getDate(),i=t.getDay();let a={day:s,date:L(t),isWeekend:!1,locked:!1,isToday:!1,isRange:!1,isSelected:!1,isHighlight:!1,events:void 0,attributes:{class:[e],style:{}},node:void 0,element:void 0};this.days=this.days||{},i!==D.SUNDAY&&i!==D.SATURDAY||(a.attributes.class.push(f),a.isWeekend=!0),(this.options.locked||this.options.disableDaysOfWeek&&this.options.disableDaysOfWeek.includes(i)||this.options.disablePastDays&&z(this.date,this.defaultDate)||this.options.minDate&&q(this.options.minDate,a.date)||this.options.maxDate&&z(this.options.maxDate,a.date))&&(a.attributes.class.push(d),a.locked=!0),this.options.disableDates&&this.disabledDays(a),$(this.todayDate,a.date)&&(a.isToday=!0,this.options.todayHighlight&&a.attributes.class.push(y)),this.daysSelected.find(t=>{$(t,a.date)&&(a.attributes.class.push(u),a.isSelected=!0)}),function(t,e,s){return U(s,t)&&W(s,e)}(this.intervalRange.begin,this.intervalRange.end,a.date)&&(a.attributes.class.push(p),a.isRange=!0),$(a.date,this.intervalRange.begin)&&a.attributes.class.push(l),$(a.date,this.intervalRange.end)&&a.attributes.class.push(c),this.daysHighlight&&this.highlightDays(a),1===a.day&&(this.options.weekStart===D.SUNDAY?a.attributes.style[this.isRTL]=i*(100/Object.keys(D).length)+"%":a.attributes.style[this.isRTL]=i===D.SUNDAY?(Object.keys(D).length-this.options.weekStart)*(100/Object.keys(D).length)+"%":(i-1)*(100/Object.keys(D).length)+"%"),a.node=A("div",a.attributes,a.day.toString()),a=this.options.beforeCreate(a),a.element=w(a.node,this.calendar.month),this.days[a.day]=a}disabledDays(t){k(this.options.disableDates[0])?this.options.disableDates.map(e=>{q(t.date,e[0])&&z(t.date,e[1])&&(t.attributes.class.push(d),t.locked=!0)}):this.options.disableDates.map(e=>{$(t.date,e)&&(t.attributes.class.push(d),t.locked=!0)})}highlightDays(t){for(const e in this.daysHighlight)this.daysHighlight[e].days[0]instanceof Array?this.daysHighlight[e].days.map(s=>{q(t.date,s[0])&&z(t.date,s[1])&&this.computedAttributes(e,t)}):this.daysHighlight[e].days.map(s=>{$(t.date,s)&&this.computedAttributes(e,t)})}computedAttributes(t,e){const{attributes:s,days:i,...a}=this.daysHighlight[t];e=C(e,a);for(const t in s)e.attributes[t]&&s[t]?e.attributes[t]=C(e.attributes[t],s[t]):s[t]&&(e.attributes[t]=s[t]);e.attributes.class.push(g),e.isHighlight=!0}monthsAsString(t){return this.options.monthShort?this.langs.monthsShort[t]:this.langs.months[t]}weekAsString(t){return this.options.weekShort?this.langs.daysShort[t]:this.langs.days[t]}mount(){this.calendar.period&&(this.calendar.period.innerHTML=this.monthsAsString(this.date.getMonth())+" "+this.date.getFullYear());const t=[];this.calendar.week.textContent="";for(let e=this.options.weekStart;e<this.langs.daysShort.length;e++)t.push(e);for(let e=0;e<this.options.weekStart;e++)t.push(e);for(const e of t)this.creatWeek(this.weekAsString(e));this.createMonth()}clearCalendar(){this.calendar.month.textContent=""}removeStatesClass(){for(const t of Object.keys(this.daysOfMonth))T(this.daysOfMonth[t],u),T(this.daysOfMonth[t],p),T(this.daysOfMonth[t],l),T(this.daysOfMonth[t],c),this.days[+t+1].isSelected=!1}}const J=G;window.HelloWeek=J,exports.HelloWeek=J,exports.createElement=A,exports.default=G,exports.el=A,exports.render=w;
